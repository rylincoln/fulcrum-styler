<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="description" content="A responsive web mapping application for viewing Fulcrum Data Shares">
    <meta name="author" content="Katrina Engelsted">
    <title name="title">Fulcrum Share Maps</title>

    <link rel="stylesheet" type="css" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="css" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
    <link rel="stylesheet" type="css" href="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css">
    <link rel="stylesheet" type="css" href="assets/libs/alertify/css/alertify-core.css">
    <link rel="stylesheet" type="css" href="assets/libs/alertify/css/alertify-bootstrap.css">
    <link rel="stylesheet" type="css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="css" href="assets/libs/bootstrap-editable/css/bootstrap-editable.css">
    <link rel="stylesheet" type="css" href="assets/libs/bootstrap-select/css/bootstrap-select.css">
    <link rel="stylesheet" type="css" href="assets/libs/bootstrap-colorpickersliders/bootstrap.colorpickersliders.css">
    <link rel="stylesheet" type="css" href="assets/libs/bootstrap-slider/css/bootstrap-slider.css">
    <link rel="stylesheet" type="css" href="assets/libs/typeahead/typeahead.css">
    <link rel="stylesheet" type="css" href="assets/libs/share/css/share.css">
    <link rel="stylesheet" type="css" href="assets/css/app.css">

    <link rel="apple-touch-icon" sizes="76x76" href="assets/img/favicon-76.png">
    <link rel="apple-touch-icon" sizes="120x120" href="assets/img/favicon-120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="assets/img/favicon-152.png">
    <link rel="icon" sizes="196x196" href="assets/img/favicon-196.png">
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico">
  </head>
   <body>
    <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container-fluid">
          <div class="navbar-header">
            <div class="navbar-icon-container">
              <a href="#" class="navbar-icon pull-right visible-xs" id="nav-btn"><i class="fa fa-bars fa-lg white"></i></a>
            </div>
            <a class="navbar-brand" href="#" name="title" id="fulcrum-zoom navbar-title"><img src="assets/img/fulcrum-small.png">Fulcrum Styler</a>
          </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li class="hidden-xs"><a href="#" data-toggle="collapse" data-target=".navbar-collapse.in" id="button-filterLayer"><i class="fa fa-pencil"></i>&nbsp;&nbsp;Filter Layer</a></li>
              <li class="hidden-xs"><a href="#" data-toggle="collapse" data-target=".navbar-collapse.in" onclick="FulcrumStyler.ui.steps.addAndCustomizeData.handlers.clickLayerConfigureInteractivity(this);" id="popup"><i class="fa fa-edit"></i>&nbsp;&nbsp;Edit Popups</a></li>
              <li class="hidden-xs"><a href="#" data-toggle="collapse" data-target=".navbar-collapse.in" onclick="FulcrumStyler.ui.steps.addAndCustomizeData.handlers.clickLayerChangeStyle(this);"><i class="fa fa-map-marker"></i>&nbsp;&nbsp;Style Your Layer</a></li>
              <li class="hidden-xs"><a class="button-refresh"><i class="fa fa-refresh"></i></a></li>
              <li class="hidden-xs"><a class="button-save"><i class="fa fa-save"></i></a></li>
            </ul>
          </div>
        </div>
      </div>
    </header>
    <section>
      <div class="content">
      <h3 class="panel-title">Map Base</h3>
        <a href="#" data-toggle="collapse" data-target=".navbar-collapse.in" class="setup buttons" id="editBaseMaps"><i class="fa fa-edit"></i>&nbsp;&nbsp;Change Basemaps</a>
        <a href="#" data-toggle="collapse" data-target=".navbar-collapse.in" class="setup buttons" id="addLayer"><i class="fa fa-map-marker"></i>&nbsp;&nbsp;Add Another Layer</a>
        <!--
            <p style="margin-top:5px;">Or upload your GeoJSON, KML, Shapefile, or File Geodatabase by dropping it into the rectangle below.</p>
            <div id="dropzone">
              <form action="/builder/upload" class="dropzone">
                <p class="dz-message">Drop files to upload (or click)</p>
              </form>
            </div>
            -->
          <div class="dd">
            <ul id="overlays" class="dd-list">
            </ul>
          </div>
          <a id="editBaseMapsAgain">Edit Basemaps</a>
          <a id="addAnotherLayer">Add an Overlay</a>
      <div id="set-center-and-zoom">
        <h3 class="panel-title">Map Center & Zoom</h3>
          <a href="#" class="setup buttons" id="fulcrum-zoom">Zoom to Fulcrum Layer</a>
          <a href="#" class="setup buttons">Set Center to <span id="current-lat">39.00</span>, <span id="current-lng">-96.00</span></a>
          <a href="#" class="setup buttons">Set Zoom to <span id="current-zoom">4</span></a>
          <a href="#" class="setup buttons">Set Center & Zoom</a>
          <a href="#" class="setup buttons">Restrict Bounds</a>
        </div>
        <div class="centering">
          <p class="help-block" style="margin:20px 0 0 0;">Initial Center: <span class="lat">39.00</span>, <span class="lng">-96.00</span><br>Initial Zoom: <span class="zoom">4</span></p>
          <h5 style="font-weight:bold;">Min and Max Zoom Levels</h5>
          <p class="help-block" style="margin-bottom:20px;">Use the slider to restrict the map to a range of zoom levels. The map's zooms will be limited to the two zooms you befine here:</p>
          <input type="text" id="set-zoom" class="form-control" required>
        </div>
        <div class="pull=left" style="margin-left:10px;">
          <form>
            <fieldset>
              <h3>Tools on the Map</h3>
              <div class="checkbox">
                <label><input type="checkbox" value="editControl">Drawing Tools</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="fullscreenControl">Fullscreen Bar</label>
              </div>
              <!-- <div class="checkbox">
                <label><input type="checkbox" value="geocoderControl">Geocoder Bar</label>
              </div> -->
              <div class="checkbox">
                <label><input type="checkbox" value="hashControl">URL Location Hash</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="homeControl" checked="checked">Home Button</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="locateControl">User Location</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="measureControl">Measuring Tools</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="overviewControl">Overview Map</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="printControl">Print Button</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="scaleControl">Scale</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="smallzoomControl" checked="checked">Zoom Buttons</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="zoomdisplayControl">Zoom Display</label>
              </div>
            </fieldset>
          </form>
          <form>
            <fieldset>
              <h3>Behavior for the Map</h3>
              <div class="checkbox">
                <label><input type="checkbox" value="dragging" checked="checked">Draggable</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="doubleClickZoom" checked="checked">Double-click Zoom</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="scrollWheelZoom" checked="checked">Scroll Wheel Zoom</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="boxZoom" checked="checked">Box Zoom</label>
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="touchZoom" checked="checked">Touch Zoom (Touchscreen)</label>
              </div>
            </fieldset>
          </form>
          <a href="#" class="export buttons" id="export" style="margin-left:0px">Share this Map</a>
        </div>
      </div>
      <div id="export-panel">
        <a href="#" class="export buttons" id="goback"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;Edit the Map</a>
        <!-- <div id="error" class="hide"></div> -->
        <div class="ssk-group ssk-count">
          <a href="#" class="buttons ssk ssk-facebook"></a>
          <a href="#" class="buttons ssk ssk-twitter" href="https://twitter.com/intent/tweet?url=Check%20out%20the%20data%20we%20have%20collected%20here: " data-counturl="https://dev.twitter.com/web/tweet-button"></a>
          <!-- <a href="#" class="buttons ssk ssk-linkedin"></a> -->
          <a href="#" class="buttons ssk ssk-email"></a>
          <!-- <a href="#" class="buttons ssk ssk-whatsapp"></a> -->
          <a href="#" id="embed" class="buttons ssk ssk-embed">Embed</a>
          <div id="sharing-code">
            <p>Copy and paste the following HTML:</p>
            <textarea id="generate-result"></textarea>
          </div>
        </div>
        <div class="pull-down">
          <div class="center-block">
            <a href="https://twitter.com/fulcrumapp" class="ssk ssk-twitter" target="_blank"></a>
            <a href="https://facebook.com/fulcrumapp" class="ssk ssk-facebook" target="_blank"></a><br>
          </div>
        <sup>Follow Fulcrum app and happenings</sup>
      </div>
      </div>
    <div id="map">
      <iframe id="iframe-map"></iframe>
    </div>
    </section>
    <div id="loading" class="progress progress-striped active">
      <div class="progress-bar" role="progressbar" aria-valuemax="100" aria-valuemin="100" aria-valuenow="100" style="width:100%;"></div>
    </div>
    <div id="mask" class="modal-backdrop in"></div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.js"></script>
    <script src="http://www.nps.gov/lib/bootstrap/3.3.2/js/nps-bootstrap.js"></script>
    <!-- <script src="assets/libs/share/js/share.js"></script> -->
    <script src="assets/libs/alertify/js/alertify.js"></script>
    <script src="assets/libs/bootstrap-colorpickersliders/bootstrap.colorpickersliders.js"></script>
    <script src="assets/libs/bootstrap-editable/js/bootstrap-editable.js"></script>
    <script src="assets/libs/bootstrap-filestyle/js/bootstrap-filestyle.js"></script>
    <script src="assets/libs/bootstrap-select/js/bootstrap-select.js"></script>
    <script src="assets/libs/bootstrap-slider/js/bootstrap-slider.js"></script>
    <script src="assets/libs/dropzone.js"></script>
    <script src="assets/libs/jquery-nestable/js/jquery-nestable.js"></script>
    <script src="assets/libs/moment.js"></script>
    <script src="assets/libs/typeahead/typeahead.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="//cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <script src="assets/js/app.js"></script>
  </body>
</html>
<script type="text/javascript">
/*
 *
 *
 *
 * Copyright (c) 2015 Ritesh Kumar
 * Licensed under the MIT license.
 */
(function ($) {
  $.fn.socialShare = function (options) {

    var defaultOptions = {
      url            : window.location.href,
      description    : $('meta[name=description]').attr("content"),
      title          : $('title').text(),
      counts         : true,
      twitter        : true,
      facebook       : true,
      pinterest      : true,
      linkedIn       : true,
      gPlus          : true,
      image          : null,
      toWord         : true,
      twitterVia     : null,
      twitterHashTags: $('meta[name=keywords]').attr("content")
    };

    var that = this;

    options = jQuery.extend({}, defaultOptions, options);

    function toWord(num) {
      if (options.toWord) {
        if (num >= 1000000000) {
          return (num / 1000000000).toFixed(1) + 'G';
        }
        if (num >= 1000000) {
          return (num / 1000000).toFixed(1) + 'M';
        }
        if (num >= 1000) {
          return (num / 1000).toFixed(1) + 'K';
        }
      }
      return num;
    }

    return this.each(function () {

      var process = {

        twitter: {

          /**
           * Get The count of twitter shares.
           * Used only when the main API has some issues.
           * @param opts
           * @returns {*} promise when the data is resolved
           */

          getCount: function (opts, counts) {
            var deferred = jQuery.Deferred();
            jQuery.getJSON('http://cdn.api.twitter.com/1/urls/count.json?url=' + opts.url + '&callback=?',
              function (data) {
                counts.twitter = data.count;
                deferred.resolve(counts);
              });
            return deferred.promise();
          }

        },

        facebook: {

          /**
           * Get The count of facebook shares.
           * Used only when the main API has some issues.
           * @param opts
           * @returns {*} promise when the data is resolved
           */

          getCount: function (opts, counts) {
            var deferred = jQuery.Deferred();
            jQuery.getJSON('https://api.facebook.com/method/links.getStats?format=json&urls=' + opts.url + '&callback=?',
              function (data) {
                counts.facebook = data[0].total_count;
                deferred.resolve(counts);
              });
            return deferred.promise();
          }
        },

        pinterest: {

          /**
           * Get The count of pinterest shares.
           * Used only when the main API has some issues.
           * @param opts
           * @returns {*} promise when the data is resolved
           */

          getCount: function (opts, counts) {
            var deferred = jQuery.Deferred();
            jQuery.getJSON('http://api.pinterest.com/v1/urls/count.json?callback=?&url=' + opts.url,
              function (data) {
                counts.pinterest = data.count;
                deferred.resolve(counts);
              });
            return deferred.promise();
          }
        },

        linkedIn: {

          /**
           * Get The count of linkedin shares.
           * Used only when the main API has some issues.
           * @param opts
           * @returns {*} promise when the data is resolved
           */

          getCount: function (opts, counts) {
            var deferred = jQuery.Deferred();
            jQuery.getJSON('https://www.linkedin.com/countserv/count/share?format=jsonp&url=' + opts.url + '&callback=?',
              function (data) {
                counts.linkedIn = data.count;
                deferred.resolve(counts);
              });
            return deferred.promise();
          }
        },

        gPlus: {

          /**
           * Get The count of G+ shares.
           * Used only when the main API has some issues.
           * This is a workaround as default api doesn't work without Authentication key.
           * @param opts
           * @returns {*} promise when the data is resolved
           */

          getCount: function (opts, counts) {
            var deferred = jQuery.Deferred();
            jQuery.getJSON('http://anyorigin.com/get?callback=?&url=' + encodeURIComponent('https://plusone.google.com/_/+1/fastbutton?url=' + opts.url),
              function (data) {
                counts.gPlus = data.contents.match(/\{c: [0-9A-Z.]+/)?parseFloat(data.contents.match(/\{c: [0-9A-Z.]+/)[0].split(' ')[1]):0;
                deferred.resolve(counts);
              });
            return deferred.promise();
          }
        }
      };

      var counts = {};

      function render(c) {
        if (options.facebook) {
          if (options.counts) {
            that.find('.facebook-count').each(function () {
              $(this).html(toWord(c.facebook));
            });
          }

          that.find('.facebook-share').each(function () {
            var url = 'https://facebook.com/sharer/sharer.php?u=' + encodeURIComponent(options.url);
            $(this).click(function () {
              openDialog(url, 'facebook');
            });
          });

        }
        if (options.twitter) {
          if (options.counts) {
            that.find('.twitter-count').each(function () {
              $(this).html(toWord(c.twitter));
            });
          }
          that.find('.twitter-share').each(function () {
            var url = 'https://twitter.com/share?url=' + options.url + '&text=' + options.description + '&via=' + options.twitterVia + '&hashtags=' + options.twitterHashTags + '';
            $(this).click(function () {
              openDialog(url, 'twitter');
            });
          });
        }
        if (options.pinterest) {
          if (options.counts) {
            that.find('.pinterest-count').each(function () {
              $(this).html(toWord(c.pinterest));
            });
          }
          that.find('.pinterest-share').each(function () {
            var url = 'https://pinterest.com/pin/create/bookmarklet/?media=' + options.image + '&url=' + options.url + '&description=' + options.description;
            $(this).click(function () {
              openDialog(url, 'pinterest');
            });
          });
        }
        if (options.linkedIn) {
          if (options.counts) {
            that.find('.linkedin-count').each(function () {
              $(this).html(toWord(c.linkedIn));
            });
          }
          that.find('.linkedin-share').each(function () {
            var url = 'http://www.linkedin.com/shareArticle?url=' + options.url;
            $(this).click(function () {
              openDialog(url, 'linkedin');
            });
          });
        }
        if (options.gPlus) {
          if (options.counts) {
            that.find('.gplus-count').each(function () {
              $(this).html(toWord(c.gPlus));
            });
          }
          that.find('.gplus-share').each(function () {
            var url = 'https://plus.google.com/share?url=' + options.url;
            $(this).click(function () {
              openDialog(url, 'gplus');
            });
          });
        }
      }

      if (options.counts) {

            $.when(
              (options.facebook ? process.facebook.getCount(options, counts) : null), (options.twitter ? process.twitter.getCount(options, counts) : null), (options.pinterest ? process.pinterest.getCount(options, counts) : null), (options.linkedIn ? process.linkedIn.getCount(options, counts) : null), (options.gPlus ? process.gPlus.getCount(options, counts) : null)
            )
              .then(function () {
                render(counts);
              });

      }
      else {
        render();
      }

      var winPosition = {
        width : 626,
        height: 336,
        left  : ($(window).width() / 2) - 313,
        top   : ($(window).height() / 3) - 168
      };

      function openDialog(url, service) {
        window.open(
          url,
          service + '-share-dialogue',
          'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + winPosition.width + ',height=' + winPosition.height + ',top=' + winPosition.top + ',left=' + winPosition.left + ''
        );
        return false;
      }



    });
  };
}(jQuery));
</script>
